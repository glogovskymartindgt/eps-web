<div class="basic-screen-header" fxLayout="row">
    <div class="pl-50" fxFlex="50" fxLayoutAlign="start center">
        <h3>{{'project.createTitle' | translate}}</h3>
    </div>
</div>

<div fxLayout="row" style="overflow: auto;  height: calc(100vh - 160px);">
    <div class="p-30">
        <form [formGroup]="projectDetailForm">
            <div fxLayout="row" fxLayoutGap="10px">
                <div fxFlex="100px" fxLayout="column">
                    <div class="short-input">
                        <div class="relative-parent">
                            <label *ngIf="hasRoleUploadImage()"
                                   class="logo-container-style"
                                   for="logo-image"
                                   fxFlex="100px"
                                   mat-ripple
                            ></label>
                            <input (change)="onLogoInserted($event)"
                                   *ngIf="hasRoleUploadImage()"
                                   accept="image/*"
                                   class="hide-input"
                                   formControlName="logo"
                                   id="logo-image"
                                   type="file"
                            >
                            <div *ngIf="hasRoleUploadImage()"
                                 class="logo-content-style logo-content-style-edit"
                            >
                                <img [src]="imageSrc"
                                     alt="project logo"
                                     class="project-logo"
                                     height="90"
                                >
                                <div class="edit-svg-wrapper">
                                    <img
                                        [src]="'assets/img/svg-squares/edit.svg'"
                                        alt="edit"
                                        class="edit-svg"
                                    >
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div fxFlex fxLayout="column" fxLayoutGap="0">
                    <div class="long-input">
                        <haz-copy-core-input [appearance]="'fill'"
                                             [label]="'project.name' |  translate"
                                             [maxLength]="50"
                                             [pattern]="notOnlyWhiteCharactersPattern"
                                             [required]="true"
                                             class="theme-input"
                                             formControlName="name"
                        >
                        </haz-copy-core-input>
                    </div>

                    <mat-form-field appearance="fill" class="long-input">
                        <mat-label>{{ 'project.projectType' | translate }}</mat-label>

                        <haz-select-search
                            [formControlName]="formControlName.PROJECT_TYPE"
                            [searchable]="true"
                            [selectList]="projectTypes$ | async"
                            [required]="true"
                        >
                        </haz-select-search>

                        <mat-error *ngIf="projectTypeControl.touched && projectTypeControl.hasError('required')">
                            {{'error.required' | translate}}
                        </mat-error>
                    </mat-form-field>

                    <div fxLayout="row" fxLayoutGap="10px">
                        <div class="short-input">
                            <haz-copy-core-input [allowedCharactersPattern]="numericPattern"
                                                 [appearance]="'fill'"
                                                 [label]="'project.year' | translate"
                                                 [maxLength]="4"
                                                 [pattern]="yearPattern"
                                                 [required]="true"
                                                 class="theme-input"
                                                 formControlName="year"
                            >
                            </haz-copy-core-input>
                        </div>
                    </div>

                    <div fxLayout="row" fxLayoutGap="10px">
                        <mat-form-field appearance="fill" class="short-input">
                            <mat-label class="label-style">{{ 'project.dateFrom' | translate }}</mat-label>
                            <input (dateChange)="onDateChanged($event.value)"
                                   [matDatepicker]="pickerDateFrom"
                                   [max]="projectDetailForm.controls.dateTo.value"
                                   formControlName="dateFrom"
                                   matInput
                            >
                            <mat-datepicker-toggle [for]="pickerDateFrom" matSuffix></mat-datepicker-toggle>
                            <mat-datepicker #pickerDateFrom [dateClass]="dateClass"></mat-datepicker>
                            <mat-error *ngIf="dateInvalid">{{ 'error.dateFormatIsInvalid' | translate }}</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="fill" class="short-input">
                            <mat-label class="label-style">{{ 'project.dateTo' | translate }}</mat-label>
                            <input (dateChange)="onDateChanged($event.value)"
                                   [matDatepicker]="pickerDateTo"
                                   [min]="projectDetailForm.controls.dateFrom.value"
                                   formControlName="dateTo"
                                   matInput
                            >
                            <mat-datepicker-toggle [for]="pickerDateTo" matSuffix></mat-datepicker-toggle>
                            <mat-datepicker #pickerDateTo [dateClass]="dateClass"></mat-datepicker>
                            <mat-error *ngIf="dateInvalid">{{ 'error.dateFormatIsInvalid' | translate }}</mat-error>
                        </mat-form-field>
                    </div>
                    <div fxLayout="row" fxLayoutGap="10px">

                        <mat-form-field appearance="fill" class="short-input">
                            <mat-label class="label-style">{{ 'project.firstCountry' | translate }}</mat-label>
                            <mat-select formControlName="firstCountry">
                                <mat-option [value]="null"></mat-option>
                                <mat-option *ngFor="let country of countryList; trackBy:trackCountryById" [value]="country.id">
                                    {{country.name}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field appearance="fill" class="short-input">
                            <mat-label class="label-style">{{ 'project.secondCountry' | translate }}</mat-label>
                            <mat-select formControlName="secondCountry">
                                <mat-option [value]="null"></mat-option>
                                <mat-option *ngFor="let country of countryList; trackBy:trackCountryById" [value]="country.id">
                                    {{country.name}}
                                </mat-option>
                            </mat-select>
                            <mat-hint *ngIf="projectDetailForm.controls.secondCountry.value
                    && !projectDetailForm.controls.firstCountry.value"
                                      style="color:#cf2120"
                            >
                                {{'error.fillFirstCountry' | translate}}
                            </mat-hint>
                        </mat-form-field>
                    </div>

                    <div fxLayout="row" fxLayoutGap="10px">
                        <div class="short-input">
                            <mat-error *ngIf="projectDetailForm.controls.firstVenue.value
                    && !projectDetailForm.controls.firstCountry.value"
                                       class="error-text"
                            >
                                {{'error.fillCountry' | translate}}
                            </mat-error>
                            <haz-copy-core-input [appearance]="'fill'"
                                                 [label]="'project.firstVenue' |  translate"
                                                 [maxLength]="50"
                                                 [pattern]="notOnlyWhiteCharactersPattern"
                                                 class="theme-input"
                                                 formControlName="firstVenue"
                            >
                            </haz-copy-core-input>
                        </div>
                        <div class="short-input">
                            <mat-error *ngIf="projectDetailForm.controls.secondVenue.value
                    && !projectDetailForm.controls.secondCountry.value" class="error-text"
                            >
                                {{'error.fillCountry' | translate}}
                            </mat-error>
                            <haz-copy-core-input [appearance]="'fill'"
                                                 [label]="'project.secondVenue' |  translate"
                                                 [maxLength]="50"
                                                 [pattern]="notOnlyWhiteCharactersPattern"
                                                 class="theme-input"
                                                 formControlName="secondVenue"
                            >
                            </haz-copy-core-input>
                        </div>
                    </div>

                    <div class="long-input">
                        <haz-copy-core-input [appearance]="'fill'"
                                             [label]="'project.description' | translate"
                                             [maxLength]="500"
                                             [pattern]="notOnlyWhiteCharactersPattern"
                                             [type]="'textarea'"
                                             class="theme-input"
                                             formControlName="description"
                        >
                        </haz-copy-core-input>
                    </div>
                </div>
            </div>
        </form>
        <div [@enterLeave] class="pl-110">
            <button (click)="onSave()"
                    [disabled]="this.projectDetailForm.invalid"
                    class="mr-10"
                    color="accent"
                    mat-flat-button
                    type="submit"
            >
                {{ 'tasks.save' | translate }}
            </button>
            <button (click)="onCancel()"
                    class="mr-10"
                    mat-button
                    type="button"
            >
                {{ 'tasks.cancel' | translate }}
            </button>
        </div>
    </div>
</div>


